import math
import numpy as np
import matplotlib.pyplot as plt

# Константы
G = 6.67408e-11  # гравитационная постоянная
M = 1.9891e30  # масса Солнца в кг
AU = 1.496e11  # астрономическая единица в метрах
v = 10000  # скорость кометы на расстоянии 100 а.е. в м/с

# Переводим расстояние от Солнца в метры
r = 100 * AU

# Вычисляем энергию кометы на бесконечности
m = 1e12  # предполагаем массу кометы в кг
E = 0.5 * m * v**2 - G * M * m / r

# Вычисляем момент импульса кометы
a = 30  # угол направления скорости кометы к оси "комета-Солнце" в градусах
h = r * v * math.cos(math.radians(a))

# Вычисляем эксцентриситет орбиты
e = math.sqrt(1 + (2 * E * h**2) / (G**2 * M**2 * m**2))

# Вычисляем минимальное и максимальное расстояния до Солнца
r_min = h**2 / (G * M * (1 + e))
r_max = h**2 / (G * M * (1 - e))

# Проверяем, является ли орбита замкнутой
if e < 1:
    print("Орбита замкнутая.")
else:
    print("Орбита незамкнутая.")

# Вычисляем угол a, при котором орбита становится замкнутой
cos_a = -G * M / (r * v**2)
a_critical = math.degrees(math.acos(cos_a))

print(f"Угол a, при котором орбита становится замкнутой: {a_critical:.2f} градусов.")

# Построение траектории кометы
if e < 1:
    # Замкнутая орбита
    theta = np.linspace(0, 2*np.pi, 1000)
    r = h**2 / (G * M * (1 + e * np.cos(theta)))
    x = r * np.cos(theta)
    y = r * np.sin(theta)
else:
    # Незамкнутая орбита
    theta = np.linspace(-np.pi, np.pi, 1000)
    r = h**2 / (G * M * (e * np.cosh(theta) - 1))
    x = r * np.cosh(theta)
    y = r * np.sinh(theta)

# Построение графика
plt.plot(x / AU, y / AU)
plt.axis('equal')
plt.title('Траектория полета кометы')
plt.xlabel('расстояние, а.е.')
plt.ylabel('расстояние, а.е.')
plt.show()